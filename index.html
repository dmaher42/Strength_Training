<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home Fitness Plan (DB + Knee-Friendly)</title>
  <style>
    :root{
      --bg-page:#f3f7fb; --bg-panel:#fff; --bg-muted:#f0f4ff;
      --text:#0f172a; --muted:#475569; --line:#d7e3f5;
      --accent:#5f8df5; --accent2:#8ab4ff;
      --done:#10b981; --missed:#ef4444;
      --shadow-lg:0 18px 36px rgba(15,23,42,.12);
      --shadow-sm:0 10px 20px rgba(15,23,42,.08);
      --r-lg:18px; --r-md:14px; --r-sm:10px;
      --s1:6px; --s2:10px; --s3:14px; --s4:18px; --s5:22px;
      --t-sm:12px; --t-md:14px; --t-lg:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      background:var(--bg-page); color:var(--text); line-height:1.5;
    }
    header{
      position:sticky; top:0; z-index:20;
      background:rgba(255,255,255,.9); backdrop-filter: blur(10px);
      border-bottom:1px solid var(--line);
    }
    .topbar{
      max-width:1100px; margin:0 auto; padding:var(--s3);
      display:flex; align-items:center; justify-content:space-between; gap:var(--s3); flex-wrap:wrap;
    }
    .brand{display:flex; align-items:center; gap:var(--s2)}
    .logo{
      width:44px; height:44px; border-radius:14px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      color:#fff; display:grid; place-items:center; font-weight:900;
      box-shadow:var(--shadow-sm);
    }
    h1{margin:0; font-size:var(--t-lg); letter-spacing:.2px}
    .sub{margin-top:2px; font-size:var(--t-sm); color:var(--muted)}
    .controls{display:flex; gap:var(--s2); flex-wrap:wrap; align-items:center}
    button,select,input{
      border:1px solid var(--line); background:#fff; color:var(--text);
      border-radius:var(--r-md); padding:10px 12px;
      font-weight:800; box-shadow:var(--shadow-sm);
    }
    button{cursor:pointer}
    button:active{transform:translateY(1px)}
    select,input{font-weight:700}
    main{max-width:1100px; margin:0 auto; padding:var(--s3) var(--s3) 90px}
    .card{
      margin-top:var(--s3); padding:var(--s3);
      border:1px solid var(--line); border-radius:var(--r-lg);
      background:var(--bg-panel); box-shadow:var(--shadow-lg);
      display:flex; flex-direction:column; gap:var(--s3);
    }
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:var(--s3)}
    .fg{display:flex; flex-direction:column; gap:6px}
    label{font-weight:900}
    small{color:var(--muted); font-size:var(--t-sm)}
    .week-meta{
      display:flex; align-items:center; justify-content:space-between; gap:var(--s3); flex-wrap:wrap;
      padding:var(--s3); border:1px solid var(--line); border-radius:var(--r-lg);
      background:linear-gradient(180deg, rgba(234,242,255,.8), #fff);
      box-shadow:var(--shadow-sm);
    }
    .pill{display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius:999px; border:1px solid var(--line); font-size:var(--t-sm)}
    .dot{width:10px; height:10px; border-radius:50%}
    .dot.done{background:var(--done)}
    .dot.miss{background:var(--missed)}
    .dot.none{background:#cbd5e1}
    .days{display:flex; flex-direction:column; gap:var(--s3)}
    .day{
      border:1px solid var(--line); border-radius:var(--r-lg); overflow:hidden;
      background:#fff; box-shadow:var(--shadow-sm);
      display:flex; flex-direction:row; min-height:140px;
    }
    @media (max-width: 860px){ .day{flex-direction:column} }
    .rail{
      flex:0 0 230px; padding:var(--s3); border-right:1px solid var(--line);
      background:linear-gradient(180deg, rgba(226,238,255,.9), #fff);
      display:flex; flex-direction:column; gap:var(--s2);
    }
    @media (max-width: 860px){ .rail{border-right:none; border-bottom:1px solid var(--line)} }
    .dayname{font-weight:900; letter-spacing:.2px}
    .tag{width:fit-content; font-size:var(--t-sm); padding:4px 8px; border-radius:999px; border:1px solid var(--line); background:rgba(95,141,245,.12)}
    .body{flex:1; padding:var(--s3); display:flex; flex-direction:column; gap:var(--s2)}
    .blk{
      border:1px solid var(--line); background:var(--bg-muted);
      border-radius:var(--r-md); padding:var(--s2); display:flex; flex-direction:column; gap:6px;
    }
    .blk h3{margin:0; font-size:var(--t-md)}
    ul{margin:6px 0 0 18px}
    .row{display:flex; gap:var(--s2); align-items:center; flex-wrap:wrap}
    .statusbtn{box-shadow:none}
    .statusbtn[data-on="true"]{outline:3px solid rgba(95,141,245,.25)}
    .statusbtn.done{border-color:rgba(16,185,129,.45)}
    .statusbtn.miss{border-color:rgba(239,68,68,.35)}
    .toast{
      position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
      background:#fff; border:1px solid var(--line); border-radius:var(--r-md);
      padding:10px 12px; box-shadow:var(--shadow-lg); font-size:var(--t-sm);
      display:none; z-index:99;
    }
    .toast.show{display:block}
    .muted{color:var(--muted)}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; font-size:12px; padding:2px 6px; border:1px solid var(--line); border-radius:8px; background:#fff}
  </style>
</head>
<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo">WF</div>
      <div>
        <h1>Wife Fitness Plan</h1>
        <div class="sub" id="subtitle">DB + bodyweight • 30–45 min • knee-friendly • 7 days/week</div>
      </div>
    </div>
    <div class="controls">
      <button id="prevWeek" aria-label="Previous week">◀ Week</button>
      <select id="weekSelect" aria-label="Select week"></select>
      <button id="nextWeek" aria-label="Next week">Week ▶</button>
      <button id="reset">Reset</button>
    </div>
  </div>
</header>

<main>
  <div class="card">
    <div class="grid">
      <div class="fg">
        <label for="duration">Session length</label>
        <select id="duration">
          <option value="30">30 minutes</option>
          <option value="35">35 minutes</option>
          <option value="40" selected>40 minutes</option>
          <option value="45">45 minutes</option>
        </select>
        <small>We auto-scale cardio + number of strength rounds.</small>
      </div>
      <div class="fg">
        <label for="kneeMode">Knee-friendly mode</label>
        <select id="kneeMode">
          <option value="on" selected>On (recommended)</option>
          <option value="off">Off (only if pain-free)</option>
        </select>
        <small>On = no jumping, no deep lunges, chair squats only.</small>
      </div>
      <div class="fg">
        <label for="weights">Dumbbell difficulty</label>
        <select id="weights">
          <option value="light" selected>Light</option>
          <option value="mod">Moderate</option>
          <option value="hard">Hard</option>
        </select>
        <small>Just changes the suggested rep ranges.</small>
      </div>
      <div class="fg">
        <label>Progress rule</label>
        <div class="muted">
          When a workout feels “easy”: add <span class="kbd">+2 reps</span> or <span class="kbd">+1–2 kg</span>.
        </div>
        <small>Never push through knee pain.</small>
      </div>
    </div>
  </div>

  <div class="week-meta" id="weekMeta"></div>
  <div class="days" id="days"></div>
</main>

<div class="toast" id="toast"></div>

<script>
  // ---- storage keys
  const KEY_SETTINGS = "wife_fitness_settings_v1";
  const KEY_STATUS   = "wife_fitness_status_v1"; // per-week, per-day

  // ---- plan data (12-week progression)
  const WEEK_PHASE = (w) => {
    if (w <= 4) return { name: "Base", note: "Build habit + form. Keep it comfortable." };
    if (w <= 8) return { name: "Build", note: "Add one extra set or a bit more pace." };
    return { name: "Shape", note: "Slightly tougher intervals + steadier strength." };
  };

  const PLAN = [
    {
      day: "Day 1",
      focus: "Lower + Core",
      tag: "Knee-friendly strength",
      blocks: (cfg) => ([
        blk("Warm-up (5 min)", [
          "March in place 2 min",
          "Hip circles + arm swings",
          "Sit-to-stand from chair × 10"
        ]),
        blk("Strength (20–25 min)", strengthLower(cfg)),
        blk("Core (5–8 min)", [
          "Dead bugs: 3×10/side",
          "Side plank (knees down ok): 2×20s/side",
          "Optional: glute bridge hold 2×20s"
        ]),
        blk("Cool down (2–5 min)", [
          "Easy walk around house + light stretching"
        ])
      ])
    },
    {
      day: "Day 2",
      focus: "Cardio",
      tag: "Low impact",
      blocks: (cfg) => ([
        blk("Warm-up (5 min)", ["Easy walk / march"]),
        blk("Main (20–30 min)", cardioSteady(cfg)),
        blk("Cool down (3–5 min)", ["Slow walk + calf/hip stretch"])
      ])
    },
    {
      day: "Day 3",
      focus: "Upper Body",
      tag: "Strength",
      blocks: (cfg) => ([
        blk("Warm-up (5 min)", ["Arm circles", "Band pull-aparts (optional)", "Wall push-ups × 10"]),
        blk("Strength (22–28 min)", strengthUpper(cfg)),
        blk("Finisher (optional 3–5 min)", ["Farmer carry: 3×30–45s", "Or incline push-ups: 2×AMRAP (stop 2 reps before failure)"])
      ])
    },
    {
      day: "Day 4",
      focus: "Intervals",
      tag: "Fat-loss friendly",
      blocks: (cfg) => ([
        blk("Warm-up (5 min)", ["Easy march / walk"]),
        blk("Intervals (20–25 min)", cardioIntervals(cfg)),
        blk("Cool down (3–5 min)", ["Slow walk + breathing downshift"])
      ])
    },
    {
      day: "Day 5",
      focus: "Full Body",
      tag: "Strength",
      blocks: (cfg) => ([
        blk("Warm-up (5 min)", ["March 2 min", "Hip hinge practice × 8", "Incline push-ups × 8"]),
        blk("Strength (22–28 min)", strengthFull(cfg)),
        blk("Mobility (3–7 min)", ["Hamstrings", "Hips", "Upper back"])
      ])
    },
    {
      day: "Day 6",
      focus: "Light Cardio + Mobility",
      tag: "Recovery",
      blocks: (cfg) => ([
        blk("Easy cardio (20–30 min)", lightCardio(cfg)),
        blk("Mobility (8–12 min)", [
          "Hip flexor stretch 60s/side",
          "Hamstring stretch 60s/side",
          "Calf stretch 60s/side",
          "Thoracic rotation 8/side"
        ])
      ])
    },
    {
      day: "Day 7",
      focus: "Active Recovery",
      tag: "Keep the habit",
      blocks: (cfg) => ([
        blk("Pick ONE (20–30 min)", [
          "Gentle walk",
          "Stretching / yoga",
          "Very easy full-body circuit (1–2 rounds)"
        ]),
        blk("Optional easy circuit (1–2 rounds)", [
          "Glute bridge × 12",
          "Incline push-ups × 8",
          "One-arm row × 10/side",
          "Dead bug × 8/side"
        ])
      ])
    }
  ];

  function blk(title, items){
    return { title, items };
  }

  function repRange(cfg){
    if (cfg.weights === "light") return "12–15 reps";
    if (cfg.weights === "hard") return "8–10 reps";
    return "10–12 reps";
  }

  function roundsForDuration(cfg){
    // quick scaling: 30=2 rounds, 35=2-3, 40=3, 45=3-4
    const d = Number(cfg.duration);
    if (d <= 30) return 2;
    if (d <= 35) return 3;
    if (d <= 40) return 3;
    return 4;
  }

  function strengthLower(cfg){
    const reps = repRange(cfg);
    const rounds = roundsForDuration(cfg);
    const kneeOn = cfg.kneeMode === "on";
    const squat = kneeOn ? "Chair goblet squat (pain-free depth)" : "Goblet squat (controlled depth)";
    return [
      `Do ${rounds} rounds, rest ~60s between moves.`,
      `${squat}: ${reps}`,
      `DB Romanian deadlift: ${reps}`,
      `Glute bridge: 15 reps`,
      `Standing calf raises: 15 reps`
    ];
  }

  function strengthUpper(cfg){
    const reps = repRange(cfg);
    const rounds = roundsForDuration(cfg);
    return [
      `Do ${rounds} rounds, rest ~60s between moves.`,
      `DB floor/bench press: ${reps}`,
      `One-arm DB row (chair/bench): ${reps}/side`,
      `Seated DB shoulder press (light): 10 reps`,
      `Lateral raises: 12 reps`,
      `Curl + triceps extension: 12 reps each`
    ];
  }

  function strengthFull(cfg){
    const reps = repRange(cfg);
    const rounds = roundsForDuration(cfg);
    const kneeOn = cfg.kneeMode === "on";
    const squat = kneeOn ? "Chair squat (goblet hold)" : "Goblet squat";
    return [
      `Do ${rounds} rounds, rest ~60s between moves.`,
      `${squat}: ${reps}`,
      `DB Romanian deadlift: ${reps}`,
      `Incline push-ups: 8–10 reps`,
      `Bent-over DB row: ${reps}`,
      `Farmer carry: 30–45 seconds`
    ];
  }

  function cardioSteady(cfg){
    const d = Number(cfg.duration);
    const main = Math.max(20, d - 10);
    return [
      `Brisk walk / treadmill walk / marching: ${main} minutes`,
      `Effort: “can talk, can’t sing”`
    ];
  }

  function cardioIntervals(cfg){
    const w = cfg.week;
    const phase = WEEK_PHASE(w).name;
    const rounds = (phase === "Base") ? 6 : (phase === "Build") ? 7 : 8;
    return [
      `Repeat ${rounds} rounds:`,
      `1 min faster walk/march + 2 min easy`,
      `No running. Keep it joint-friendly.`
    ];
  }

  function lightCardio(cfg){
    const d = Number(cfg.duration);
    const main = Math.max(20, d - 10);
    return [
      `Easy walk / easy march: ${main} minutes`,
      `Keep it comfortable (recovery pace)`
    ];
  }

  // ---- rendering + state
  const elDays = document.getElementById("days");
  const elMeta = document.getElementById("weekMeta");
  const elWeek = document.getElementById("weekSelect");
  const elToast = document.getElementById("toast");

  const settings = load(KEY_SETTINGS, {
    week: 1,
    duration: "40",
    kneeMode: "on",
    weights: "light"
  });

  // week select
  for (let i=1;i<=12;i++){
    const opt = document.createElement("option");
    opt.value = String(i);
    opt.textContent = `Week ${i}`;
    elWeek.appendChild(opt);
  }

  // hydrate controls
  document.getElementById("duration").value = settings.duration;
  document.getElementById("kneeMode").value = settings.kneeMode;
  document.getElementById("weights").value = settings.weights;
  elWeek.value = String(settings.week);

  document.getElementById("duration").addEventListener("change", (e)=>{ settings.duration = e.target.value; save(KEY_SETTINGS, settings); render(); toast("Saved."); });
  document.getElementById("kneeMode").addEventListener("change", (e)=>{ settings.kneeMode = e.target.value; save(KEY_SETTINGS, settings); render(); toast("Saved."); });
  document.getElementById("weights").addEventListener("change", (e)=>{ settings.weights = e.target.value; save(KEY_SETTINGS, settings); render(); toast("Saved."); });

  elWeek.addEventListener("change", (e)=>{ settings.week = Number(e.target.value); save(KEY_SETTINGS, settings); render(); });

  document.getElementById("prevWeek").addEventListener("click", ()=>{
    settings.week = Math.max(1, settings.week - 1);
    elWeek.value = String(settings.week);
    save(KEY_SETTINGS, settings);
    render();
  });
  document.getElementById("nextWeek").addEventListener("click", ()=>{
    settings.week = Math.min(12, settings.week + 1);
    elWeek.value = String(settings.week);
    save(KEY_SETTINGS, settings);
    render();
  });

  document.getElementById("reset").addEventListener("click", ()=>{
    if (!confirm("Reset ALL saved status + settings?")) return;
    localStorage.removeItem(KEY_SETTINGS);
    localStorage.removeItem(KEY_STATUS);
    location.reload();
  });

  function render(){
    const cfg = { ...settings, week: Number(settings.week) };
    const phase = WEEK_PHASE(cfg.week);
    const status = load(KEY_STATUS, {});
    const weekKey = `w${cfg.week}`;

    // meta
    const doneCount = PLAN.reduce((acc, _, idx)=>{
      const s = (status[weekKey]||{})[idx];
      return acc + (s === "done" ? 1 : 0);
    },0);
    const missCount = PLAN.reduce((acc, _, idx)=>{
      const s = (status[weekKey]||{})[idx];
      return acc + (s === "missed" ? 1 : 0);
    },0);

    elMeta.innerHTML = `
      <div>
        <div style="font-weight:900;font-size:16px">Week ${cfg.week} • ${phase.name}</div>
        <div class="muted" style="font-size:12px">${phase.note}</div>
      </div>
      <div class="row">
        <span class="pill"><span class="dot done"></span>Done: <b>${doneCount}</b></span>
        <span class="pill"><span class="dot miss"></span>Missed: <b>${missCount}</b></span>
        <span class="pill"><span class="dot none"></span>Planned: <b>${7 - doneCount - missCount}</b></span>
      </div>
    `;

    // days
    elDays.innerHTML = "";
    PLAN.forEach((d, idx)=>{
      const dayStatus = ((status[weekKey]||{})[idx]) || "planned";
      const blocks = d.blocks(cfg);

      const dayEl = document.createElement("div");
      dayEl.className = "day";
      dayEl.innerHTML = `
        <div class="rail">
          <div class="dayname">${d.day}</div>
          <div style="font-weight:900">${d.focus}</div>
          <div class="tag">${d.tag}</div>
          <div class="muted" style="font-size:12px">Target: ${cfg.duration} min</div>
          <div class="row" style="margin-top:6px">
            <button class="statusbtn done" data-action="done">Mark done</button>
            <button class="statusbtn miss" data-action="missed">Mark missed</button>
            <button class="statusbtn" data-action="planned">Clear</button>
          </div>
          <div class="muted" style="font-size:12px">
            Status: <b>${dayStatus}</b>
          </div>
        </div>
        <div class="body"></div>
      `;

      const body = dayEl.querySelector(".body");
      blocks.forEach(b=>{
        const blkEl = document.createElement("div");
        blkEl.className = "blk";
        blkEl.innerHTML = `
          <h3>${b.title}</h3>
          <ul>${b.items.map(x=>`<li>${escapeHtml(x)}</li>`).join("")}</ul>
        `;
        body.appendChild(blkEl);
      });

      dayEl.querySelectorAll("button.statusbtn").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const action = btn.getAttribute("data-action");
          const st = load(KEY_STATUS, {});
          st[weekKey] = st[weekKey] || {};
          if (action === "planned") delete st[weekKey][idx];
          else st[weekKey][idx] = action;
          save(KEY_STATUS, st);
          toast(action === "planned" ? "Cleared." : `Marked ${action}.`);
          render();
        });
      });

      elDays.appendChild(dayEl);
    });
  }

  function toast(msg){
    elToast.textContent = msg;
    elToast.classList.add("show");
    clearTimeout(toast._t);
    toast._t = setTimeout(()=>elToast.classList.remove("show"), 1400);
  }

  function save(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
  function load(k, fallback){
    try{
      const raw = localStorage.getItem(k);
      return raw ? JSON.parse(raw) : fallback;
    }catch(e){ return fallback; }
  }
  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g, (c)=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;" }[c]));
  }

  render();
</script>
</body>
</html>
